<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mercedez Sylvia Portfolio</title>
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
	<link rel="icon" href="favicon.ico" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet">
    <link rel="stylesheet" href="libs/font-awesome/css/font-awesome.min.css">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>
	<div>
        <div class="container">
            <div class="row">
                <div>
                    <h2 class="heading">Automation Collection</h2>
					<p>Overall goal of these automation functions are to increase efficiency and quality, while reducing risk and waste.</p>
                </div>
				<div>
				<h3>
				Update Graphic Heights
				</h3>
				<p>The graphic height is calculated when the Update Image Heights or Set Single Image Height command is run. It calculates the height in relation to the width attribute. It determines the height of the graphic in the final output of the HTML document.</p>
				<p>If there is no width attribute set, the height is not set when the command is run.</p>
				</div>
				<div id="pre">
					
<code>
function updateImageHeight(){

	delete($oid_graphics);
	delete($oid_inlinegraphics);
	$graphicsUpdated=0;
	$inlineGraphicsUpdated=0;
	$missingWidth=0;
	$currentGraphicHeight="";
	$currentGraphicWidth="";
	$newGrapicHeight="";
	$currentInlWidth="";
	$currentInlHeight="";
	$newInlHeight="";

	oid_find_children(oid_first(), oid_graphics, "graphic")			
	oid_find_children(oid_first(), oid_inlinegraphics, "inlinegraphic")

	#graphics
	if(count($oid_graphics)>0) {
		for($eachGraphic in $oid_graphics)
		{
			oid_graphic_size($oid_graphics[$eachGraphic], imgWidth, imgHeight, 1)
			$currentGraphicHeight=oid_attr($oid_graphics[$eachGraphic], "height")
			$currentGraphicWidth=oid_attr($oid_graphics[$eachGraphic], "width")
			
			#The height is only calculated if there is a width attribute set.	
			if($currentGraphicWidth!=""){
				#find the correct height in pixels
				$newGrapicHeight=javascript("(((".javascript(substr($currentGraphicWidth,1,(length($currentGraphicWidth)-2))." * 96")." * ".imgHeight.")/".imgWidth.")).toFixed(0)")."px";
			
				#if height missing or if current height doesnt match new height, set new height. 
				if($currentGraphicHeight=="" || $currentGraphicHeight!=$newGrapicHeight){
					#set the attribute height.			
					oid_modify_attr($oid_graphics[$eachGraphic], "height", $newGrapicHeight)
					$graphicsUpdated++
				}
			}
			else{
				$missingWidth++
				$missingGraphicWidth[$missingWidth]=oid_attr($oid_graphics[$eachGraphic], "entityref")
			}
		}
	}
	#inlinegraphics
	if(count($oid_inlinegraphics)>0){	
		for($eachInlineGraphic in $oid_inlinegraphics){
			oid_graphic_size(oid_inlinegraphics[eachInlineGraphic], inlWidth, inlHeight, 1)
			$currentInlWidth=oid_attr(oid_inlinegraphics[eachInlineGraphic], "width")
			$currentInlHeight=oid_attr(oid_inlinegraphics[eachInlineGraphic], "height")
			
			#The height is only calculated if there is a width attribute set.		
			if($currentInlWidth!=""){
				#Get height in pixels
				$newInlHeight=javascript("(((".javascript(substr($currentInlWidth,1,(length($currentInlWidth)-2))." * 96")." * ".inlHeight.")/".inlWidth.")).toFixed(0)")."px"; 
			
				#if height is missing or if current height does not match new height, set new height. 
				if($currentInlHeight=="" || $currentInlHeight!=$newInlHeight){
					#set the attribute height.			
					oid_modify_attr($oid_inlinegraphics[$eachInlineGraphic], "height", $newInlHeight)
					$inlineGraphicsUpdated++
				}				
			}
			else{
				$missingInlWidth++
				$missingInlGraphicWidth[$missingInlWidth]="true"
			
			}
		}
	}
	if(count($oid_graphics)==0 && count($oid_inlinegraphics)==0){
		message_box("No graphics were found.", 0x00, "Update Image Heights")
	}
	else{
		#Display message and popup window to show complete. 
		if($graphicsUpdated>0){$graphicsMessage="\nGraphics updated: ".$graphicsUpdated}else{$graphicsMessage=""}
		if($inlineGraphicsUpdated>0){$InlineMessage="\nInline Graphics updated: ".$inlineGraphicsUpdated}else{$InlineMessage=""}
		#message_box("Image heights set.\n".$graphicsMessage.$InlineMessage, 0x00, "Update Image Heights") 	
		eval "Image heights set.\n".$graphicsMessage.$InlineMessage output=>*
	}
	if(count($missingGraphicWidth)>0){
		eval "\n\n\n\n\nThe following graphics are missing widths:" output=>*
		for($eachgraphic in $missingGraphicWidth){
			eval "\n   -".$missingGraphicWidth[$eachgraphic] output=>*
		}
	}
	if(count($missingInlGraphicWidth)>0){
		eval "\n\n\n\n\nRun Validate Inline Grapics" output=>*
	}
}
</code>
					
				
				</div>
            </div>

				<div>
				<h3>
				Reset Revdate
				</h3>
				<p>Set Revision Dates to xx/xx/xxxx sets all subsequent siblings and children sections revision dates to xx/xx/xxxx. Starting at section the cursor is located, the dates are changed for subsequent siblings and children sections, but stops once the last subsequent section or end of the manual is reached.</p>
				</div>
			<div id="pre">
			<code>
	function resetRevdate(){
	#This function changes all the revdates for the currently selected element, all subsequent siblings, and the children of self and all siblings. 
	#Cursor placement is vital. 
	
	# Build the user input menu.
	
	$choice = response("You are about to set the revision date attribute to xx/xx/xxxx for this element, and all child elements. Are you sure you want to proceed?", "Yes", "No")
	
	# If 'OK' is selected, search and replace. 
	if ($choice == 1 ) {	
		
		$countRevdateChanges =0;
	
		#Find the cursor location element.
		selectedElement = oid_current_tag();
				
		#eval "\n Revdate Modified: ".oid_attr(selectedElement, "revdate") output=>*	
		
		#loop through all siblings starting with the selectedElement
		while (oid_valid(selectedElement)){
			
				oid_modify_attr(selectedElement, "revdate", "xx/xx/xxxx");
					
				#eval " > ".oid_attr(selectedElement, "revdate") output=>*
				
				#Find child attributes that have a revdate.
				oid_find_child_attrs(selectedElement, oid_revdates, "revdate");
				
				if (oid_attr(selectedElement, "revdate")){
					$countRevdateChanges +=1;
				}
				
				#Change the revdate for the children of the selected element.
				for(rdate in oid_revdates){
				
					#eval "\n Revdate Modified: ".oid_attr(oid_revdates[rdate], "revdate") output=>*	
					
					oid_modify_attr(oid_revdates[rdate], "revdate", "xx/xx/xxxx");
					
					#eval " > ".oid_attr(oid_revdates[rdate], "revdate") output=>*
					$countRevdateChanges +=1;
				}
			#next sibling
			selectedElement = oid_next(selectedElement)	
		}
		
		eval "\n Revdates changed: ".$countRevdateChanges output=>*
	}
	
}	
			</code>
			</div>
        </div>
    </div>
</body>
</html>